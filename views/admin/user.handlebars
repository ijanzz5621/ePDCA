<h3>User</h3>

<div id="icon-list">
  <img src="/img/add-icon.png" id="icon-add-user" width="32px" class="icon-maint" onclick="iconTrigger(this);"/>
</div>

<table id="userList" class="table table-bordered table-responsive table-striped">
  <thead>
    <tr>
      <th data-dynatable-column="UserCode">Employee ID</th>
      <th data-dynatable-column="Username">Name</th>
      <th data-dynatable-column="Email">Email</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>

<script type="text/javascript">

      $(document).ready(function () {

        //alert('test load');

        //$('#userList').dynatable();
        $.ajax({
          url: "/api/users", success: function (result) {
            //$("#div1").html(result);
            //alert(result);
            $('#userList').dynatable({
              dataset: {
                records: result
              }
            }).on('dblclick', 'tr', function(){
              //alert(this.Email);
              var cells = this.getElementsByTagName('td');
              //alert(cells[0].innerHTML);
              //call popup
              callModal(cells[0].innerHTML);

            });
          }
        });

        /*$('#userList').dynatable({
          dataset: {
            ajax: true,
            ajaxUrl: '/api/users',
            ajaxOnLoad: true,
            records: []
          };*/



      });

      function iconTrigger(obj){
          //alert($(obj).attr('id'));
          var selectedIcon = $(obj).attr('id');
          if (selectedIcon === "icon-add-user"){
            $('#modal-add-user').modal();
          }
      }

      function callModal(id){
        
        //use ajax to retrieve info from id

        //populate the details into the popup form

        $('#modal-add-user').modal();
      }

</script>

{{> admin/user-add}}